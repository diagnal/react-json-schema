"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var _react=require("react");var _reactDomFactories=require("react-dom-factories");var _reactDomFactories2=_interopRequireDefault(_reactDomFactories);var _server=require("react-dom/server");var _server2=_interopRequireDefault(_server);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _objectWithoutProperties(e,t){var r={};for(var n in e){if(t.indexOf(n)>=0)continue;if(!Object.prototype.hasOwnProperty.call(e,n))continue;r[n]=e[n]}return r}function _classCallCheck(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var _componentMap=new WeakMap;var ReactJsonSchema=function(){function e(){_classCallCheck(this,e)}_createClass(e,[{key:"parseSchema",value:function e(t,r){var n=null;var a=null;if(r){t.toStaticMarkup=r}if(Array.isArray(t)){a=this.parseSubSchemas(t,r)}else if(t){n=this.createComponent(t,r)}return n||a}},{key:"parseSubSchemas",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var r=arguments[1];var n=[];var a=0;var o=true;var i=false;var c=undefined;try{for(var u=t[Symbol.iterator](),s;!(o=(s=u.next()).done);o=true){var l=s.value;l.key=typeof l.key!=="undefined"?l.key:a;n.push(this.parseSchema(l,r));a++}}catch(e){i=true;c=e}finally{try{if(!o&&u.return){u.return()}}finally{if(i){throw c}}}return n}},{key:"createComponent",value:function e(t,r){var n=t.component,a=t.children,o=t.text,i=_objectWithoutProperties(t,["component","children","text"]);var c=this.resolveComponent(t);var u=typeof o!=="undefined"?o:this.resolveComponentChildren(t,r);return(0,_react.createElement)(c,i,u)}},{key:"resolveComponent",value:function e(t){var r=this.getComponentMap();var n=null;if(t.hasOwnProperty("component")){if(t.component===Object(t.component)){n=t.component}else if(r&&r[t.component]){n=r[t.component]}else if(_reactDomFactories2.default.hasOwnProperty(t.component)){n=t.component}}else{throw new Error("ReactJsonSchema could not resolve a component due to a missing component attribute in the schema.")}return n}},{key:"resolveComponentChildren",value:function e(t,r){return t.hasOwnProperty("children")?this.parseSchema(t.children,r):undefined}},{key:"getComponentMap",value:function e(){return _componentMap.get(this)}},{key:"setComponentMap",value:function e(t){_componentMap.set(this,t)}},{key:"getStaticMarkup",value:function e(t){t.toStaticMarkup=true;return _server2.default.renderToStaticMarkup(this.parseSchema(t,t.toStaticMarkup))}}]);return e}();exports.default=ReactJsonSchema;